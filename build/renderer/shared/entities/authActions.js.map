{"version":3,"sources":["../../../../app/renderer/shared/entities/authActions.js"],"names":["invalidateAuthenticatedUser","fetchAuthenticatedUserIfNeeded","LOAD_AUTHENTICATED_USER","AUTHENTICATED_USER_LOADED","INVALIDATE_AUTHENTICATED_USER","requestAuthenticatedUser","type","receiveAuthenticatedUser","user","fetchAuthenticatedUser","dispatch","then","response","authenticated","id","catch","shouldFetchAuthenticatedUser","state","auth","getState"],"mappings":";;;;;;QAuCgBA,2B,GAAAA,2B;QAMAC,8B,GAAAA,8B;;AA7ChB;;AAEO,MAAMC,4DAA0B,yBAAhC;AACA,MAAMC,gEAA4B,2BAAlC;AACA,MAAMC,wEAAgC,+BAAtC;;AAEP,SAASC,wBAAT,GAAoC;AAClC,SAAO;AACLC,UAAMJ;AADD,GAAP;AAGD;;AAED,SAASK,wBAAT,CAAkCC,IAAlC,EAAwC;AACtC,SAAO;AACLF,UAAMH,yBADD;AAELK;AAFK,GAAP;AAID;;AAED,SAASC,sBAAT,GAAkC;AAChC,SAAQC,QAAD,IAAc;AACnBA,aAASL,0BAAT;AACA,WAAO,+BAAW,cAAX,EAA2BM,IAA3B,CAAiCC,QAAD,IAAc;AACnD,UAAIA,SAASC,aAAT,KAA2B,IAA/B,EAAqC;AACnC,eAAO,+BAAW,UAAX,EAAuBF,IAAvB,CAA6BC,QAAD,IAAc;AAC/CF,mBAASH,yBAAyBK,SAASE,EAAT,GAAcF,QAAd,GAAyB,EAAEC,eAAe,KAAjB,EAAlD,CAAT;AACD,SAFM,CAAP;AAGD;AACDH,eAASH,yBAAyB,EAAEM,eAAe,KAAjB,EAAzB,CAAT;AACD,KAPM,EAOJE,KAPI,CAOE,MAAM;AACbL,eAASH,yBAAyB,EAAEM,eAAe,KAAjB,EAAzB,CAAT;AACD,KATM,CAAP;AAUD,GAZD;AAaD;;AAED,SAASG,4BAAT,CAAsCC,KAAtC,EAA6C;AAC3C,SAAQA,MAAMC,IAAN,IAAY,IAAZ,IAAoBD,MAAMC,IAAN,CAAWV,IAAX,KAAoB,IAAhD,CAD2C,CACU;AACtD;;AAEM,SAASR,2BAAT,GAAuC;AAC5C,SAAO;AACLM,UAAMF;AADD,GAAP;AAGD;;AAEM,SAASH,8BAAT,GAA0C;AAC/C,SAAO,CAACS,QAAD,EAAWS,QAAX,KAAwB;AAC7B,QAAIH,6BAA6BG,UAA7B,CAAJ,EAA8C;AAC5C,aAAOT,SAASD,wBAAT,CAAP;AACD;AACD,WAAO,IAAP;AACD,GALD;AAMD","file":"authActions.js","sourcesContent":["import { getRequest } from '../utils/ApiRepository'\n\nexport const LOAD_AUTHENTICATED_USER = 'LOAD_AUTHENTICATED_USER'\nexport const AUTHENTICATED_USER_LOADED = 'AUTHENTICATED_USER_LOADED'\nexport const INVALIDATE_AUTHENTICATED_USER = 'INVALIDATE_AUTHENTICATED_USER'\n\nfunction requestAuthenticatedUser() {\n  return {\n    type: LOAD_AUTHENTICATED_USER\n  }\n}\n\nfunction receiveAuthenticatedUser(user) {\n  return {\n    type: AUTHENTICATED_USER_LOADED,\n    user\n  }\n}\n\nfunction fetchAuthenticatedUser() {\n  return (dispatch) => {\n    dispatch(requestAuthenticatedUser())\n    return getRequest('auths/status').then((response) => {\n      if (response.authenticated === true) {\n        return getRequest('users/me').then((response) => {\n          dispatch(receiveAuthenticatedUser(response.id ? response : { authenticated: false }))\n        })\n      }\n      dispatch(receiveAuthenticatedUser({ authenticated: false }))\n    }).catch(() => {\n      dispatch(receiveAuthenticatedUser({ authenticated: false }))\n    })\n  }\n}\n\nfunction shouldFetchAuthenticatedUser(state) {\n  return (state.auth==null || state.auth.user === null)// && state.auth.isFetching === false\n}\n\nexport function invalidateAuthenticatedUser() {\n  return {\n    type: INVALIDATE_AUTHENTICATED_USER\n  }\n}\n\nexport function fetchAuthenticatedUserIfNeeded() {\n  return (dispatch, getState) => {\n    if (shouldFetchAuthenticatedUser(getState())) {\n      return dispatch(fetchAuthenticatedUser())\n    }\n    return null\n  }\n}\n"]}